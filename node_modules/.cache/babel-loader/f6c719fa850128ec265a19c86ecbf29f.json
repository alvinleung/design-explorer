{"ast":null,"code":"var _jsxFileName = \"/Users/alvinleung/Google Drive/Projects/alvinleung-portfolio/design-explorer/src/components/designExplorer/viewport/Viewport.js\";\nimport React, { useState, useRef } from \"react\";\nimport \"./Viewport.scss\"; // purpose of this component\n// Referenced tutorial\n// https://stackoverflow.com/questions/20926551/recommended-way-of-making-react-component-div-draggable\n\nfunction Viewport(props) {\n  // mode toggles for the components\n  const [dragging, setDragging] = useState(false); // managing zoom\n\n  const ZOOMMODE_IDLE = 0;\n  const ZOOMMODE_IN = 1;\n  const ZOOMMODE_OUT = 2;\n  const [zooming, setZooming] = useState(ZOOMMODE_IDLE);\n  const zoomStep = 10;\n  const [viewportZoom, setViewportZoom] = useState(1); // the screen coordinate of the zoom point\n\n  const [zoomPivot, setZoomPivot] = useState({\n    x: 0,\n    y: 0\n  }); // handling the position panning state\n\n  const [viewportOffsetPos, setViewportOffsetPos] = useState({\n    x: 0,\n    y: 0\n  });\n  const [dragOffset, setDragOffset] = useState({\n    x: 0,\n    y: 0\n  }); // grab the html reference of the container to get the beginning position\n\n  const viewportContainerRef = useRef(null);\n  const viewportPannerRef = useRef(null);\n\n  function mouseClickHandler(e) {\n    if (zooming === ZOOMMODE_IN) {\n      setViewportZoom(viewportZoom + zoomStep);\n    } else if (zooming === ZOOMMODE_OUT) {}\n  }\n\n  function mouseDownHandler(e) {\n    // enter the moving state\n    e.stopPropagation();\n    e.preventDefault(); // enter dragging mode\n\n    setDragging(true); // initialise drag offset value\n\n    const viewportElmPagePos = {\n      x: viewportContainerRef.current.getBoundingClientRect().left,\n      y: viewportContainerRef.current.getBoundingClientRect().top\n    };\n    setDragOffset({\n      x: e.nativeEvent.pageX - viewportElmPagePos.x - viewportOffsetPos.x,\n      y: e.nativeEvent.pageY - viewportElmPagePos.y - viewportOffsetPos.y\n    });\n  }\n\n  function mouseUpHandler(e) {\n    // exit dragging mode\n    setDragging(false);\n  }\n\n  function mouseWheelHandler(e) {\n    // stop the document from scrolling when the user mouse over this\n    e.nativeEvent.preventDefault(); // pan around the viewport using scroll wheel when the zooming mode is not active\n\n    setViewportOffsetPos({\n      x: viewportOffsetPos.x - e.nativeEvent.deltaX,\n      y: viewportOffsetPos.y - e.nativeEvent.deltaY\n    }); // calculate zoom value\n\n    const newZoomValue = viewportZoom - e.nativeEvent.deltaY * 10; // set the focus point of zoom\n    // TODO: create figure out how to have it zoom according to the mouse pointing position\n\n    const viewportRect = viewportContainerRef.current.getBoundingClientRect();\n    setZoomPivot({\n      x: viewportRect.width / 2,\n      y: viewportRect.height / 2\n    }); // set the zoom level\n\n    setViewportZoom(newZoomValue);\n  }\n\n  function mouseMoveHandler(e) {\n    if (dragging) {\n      // more about clientX/pageX/screenX\n      // https://stackoverflow.com/questions/6073505/what-is-the-difference-between-screenx-y-clientx-y-and-pagex-y/9335517\n      const maxPos = {\n        x: 0,\n        y: 0\n      };\n      const minPos = {\n        x: -(viewportContainerRef.current.scrollWidth - viewportContainerRef.current.clientWidth),\n        y: -(viewportContainerRef.current.scrollHeight - viewportContainerRef.current.clientHeight)\n      };\n      setViewportOffsetPos({\n        // for some reason react glitches when we use offsetX\n        x: clamp(e.nativeEvent.pageX - dragOffset.x, minPos.x, maxPos.x),\n        y: clamp(e.nativeEvent.pageY - dragOffset.y, minPos.y, maxPos.y)\n      });\n    }\n  } // move the viewport\n\n\n  if (viewportContainerRef.current) {\n    viewportContainerRef.current.scrollLeft = -viewportOffsetPos.x;\n    viewportContainerRef.current.scrollTop = -viewportOffsetPos.y;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"viewport-container\",\n    onMouseDown: mouseDownHandler,\n    onMouseUp: mouseUpHandler,\n    onMouseMove: mouseMoveHandler,\n    onClick: mouseClickHandler,\n    onWheel: mouseWheelHandler,\n    ref: viewportContainerRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {// transform: `translate(${viewportOffsetPos.x}px, ${viewportOffsetPos.y}px)`,\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, \"test\", /*#__PURE__*/React.createElement(\"div\", {\n    className: \"viewport-content\",\n    style: {\n      transformOrigin: `${-viewportOffsetPos.x + zoomPivot.x}px ${-viewportOffsetPos.y + zoomPivot.y}px `,\n      transform: `perspective(500px) translate3d(0,0, ${viewportZoom}px)`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, props.src.map((imgUrl, index) => {\n    return /*#__PURE__*/React.createElement(\"img\", {\n      id: index,\n      key: index,\n      src: imgUrl,\n      alt: \"Design Section\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 15\n      }\n    });\n  }))));\n}\n\nfunction clamp(value, min, max) {\n  if (value < min) return min;\n  if (value > max) return max;\n  return value;\n}\n\nexport default Viewport;","map":{"version":3,"sources":["/Users/alvinleung/Google Drive/Projects/alvinleung-portfolio/design-explorer/src/components/designExplorer/viewport/Viewport.js"],"names":["React","useState","useRef","Viewport","props","dragging","setDragging","ZOOMMODE_IDLE","ZOOMMODE_IN","ZOOMMODE_OUT","zooming","setZooming","zoomStep","viewportZoom","setViewportZoom","zoomPivot","setZoomPivot","x","y","viewportOffsetPos","setViewportOffsetPos","dragOffset","setDragOffset","viewportContainerRef","viewportPannerRef","mouseClickHandler","e","mouseDownHandler","stopPropagation","preventDefault","viewportElmPagePos","current","getBoundingClientRect","left","top","nativeEvent","pageX","pageY","mouseUpHandler","mouseWheelHandler","deltaX","deltaY","newZoomValue","viewportRect","width","height","mouseMoveHandler","maxPos","minPos","scrollWidth","clientWidth","scrollHeight","clientHeight","clamp","scrollLeft","scrollTop","transformOrigin","transform","src","map","imgUrl","index","value","min","max"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\nimport \"./Viewport.scss\";\n\n// purpose of this component\n\n// Referenced tutorial\n// https://stackoverflow.com/questions/20926551/recommended-way-of-making-react-component-div-draggable\n\nfunction Viewport(props) {\n  // mode toggles for the components\n  const [dragging, setDragging] = useState(false);\n\n  // managing zoom\n  const ZOOMMODE_IDLE = 0;\n  const ZOOMMODE_IN = 1;\n  const ZOOMMODE_OUT = 2;\n\n  const [zooming, setZooming] = useState(ZOOMMODE_IDLE);\n  const zoomStep = 10;\n  const [viewportZoom, setViewportZoom] = useState(1);\n  // the screen coordinate of the zoom point\n  const [zoomPivot, setZoomPivot] = useState({ x: 0, y: 0 });\n\n  // handling the position panning state\n  const [viewportOffsetPos, setViewportOffsetPos] = useState({ x: 0, y: 0 });\n  const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });\n\n  // grab the html reference of the container to get the beginning position\n  const viewportContainerRef = useRef(null);\n  const viewportPannerRef = useRef(null);\n\n  function mouseClickHandler(e) {\n    if (zooming === ZOOMMODE_IN) {\n      setViewportZoom(viewportZoom + zoomStep);\n    } else if (zooming === ZOOMMODE_OUT) {\n    }\n  }\n\n  function mouseDownHandler(e) {\n    // enter the moving state\n    e.stopPropagation();\n    e.preventDefault();\n\n    // enter dragging mode\n    setDragging(true);\n\n    // initialise drag offset value\n    const viewportElmPagePos = {\n      x: viewportContainerRef.current.getBoundingClientRect().left,\n      y: viewportContainerRef.current.getBoundingClientRect().top,\n    };\n\n    setDragOffset({\n      x: e.nativeEvent.pageX - viewportElmPagePos.x - viewportOffsetPos.x,\n      y: e.nativeEvent.pageY - viewportElmPagePos.y - viewportOffsetPos.y,\n    });\n  }\n\n  function mouseUpHandler(e) {\n    // exit dragging mode\n    setDragging(false);\n  }\n\n  function mouseWheelHandler(e) {\n    // stop the document from scrolling when the user mouse over this\n    e.nativeEvent.preventDefault();\n\n    // pan around the viewport using scroll wheel when the zooming mode is not active\n    setViewportOffsetPos({\n      x: viewportOffsetPos.x - e.nativeEvent.deltaX,\n      y: viewportOffsetPos.y - e.nativeEvent.deltaY,\n    });\n\n    // calculate zoom value\n    const newZoomValue = viewportZoom - e.nativeEvent.deltaY * 10;\n\n    // set the focus point of zoom\n    // TODO: create figure out how to have it zoom according to the mouse pointing position\n    const viewportRect = viewportContainerRef.current.getBoundingClientRect();\n    setZoomPivot({\n      x: viewportRect.width / 2,\n      y: viewportRect.height / 2,\n    });\n\n    // set the zoom level\n    setViewportZoom(newZoomValue);\n  }\n\n  function mouseMoveHandler(e) {\n    if (dragging) {\n      // more about clientX/pageX/screenX\n      // https://stackoverflow.com/questions/6073505/what-is-the-difference-between-screenx-y-clientx-y-and-pagex-y/9335517\n\n      const maxPos = {\n        x: 0,\n        y: 0,\n      };\n      const minPos = {\n        x: -(\n          viewportContainerRef.current.scrollWidth -\n          viewportContainerRef.current.clientWidth\n        ),\n        y: -(\n          viewportContainerRef.current.scrollHeight -\n          viewportContainerRef.current.clientHeight\n        ),\n      };\n      setViewportOffsetPos({\n        // for some reason react glitches when we use offsetX\n        x: clamp(e.nativeEvent.pageX - dragOffset.x, minPos.x, maxPos.x),\n        y: clamp(e.nativeEvent.pageY - dragOffset.y, minPos.y, maxPos.y),\n      });\n    }\n  }\n\n  // move the viewport\n  if (viewportContainerRef.current) {\n    viewportContainerRef.current.scrollLeft = -viewportOffsetPos.x;\n    viewportContainerRef.current.scrollTop = -viewportOffsetPos.y;\n  }\n\n  return (\n    <div\n      className=\"viewport-container\"\n      onMouseDown={mouseDownHandler}\n      onMouseUp={mouseUpHandler}\n      onMouseMove={mouseMoveHandler}\n      onClick={mouseClickHandler}\n      onWheel={mouseWheelHandler}\n      ref={viewportContainerRef}\n    >\n      {/* outer div control the panning */}\n      <div\n        style={\n          {\n            // transform: `translate(${viewportOffsetPos.x}px, ${viewportOffsetPos.y}px)`,\n          }\n        }\n      >\n        test\n        {/* inner div control the zooming */}\n        <div\n          className=\"viewport-content\"\n          style={{\n            transformOrigin: `${-viewportOffsetPos.x + zoomPivot.x}px ${\n              -viewportOffsetPos.y + zoomPivot.y\n            }px `,\n            transform: `perspective(500px) translate3d(0,0, ${viewportZoom}px)`,\n          }}\n        >\n          {props.src.map((imgUrl, index) => {\n            return (\n              <img id={index} key={index} src={imgUrl} alt=\"Design Section\" />\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction clamp(value, min, max) {\n  if (value < min) return min;\n  if (value > max) return max;\n  return value;\n}\n\nexport default Viewport;\n"]},"metadata":{},"sourceType":"module"}